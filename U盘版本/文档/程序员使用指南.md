# 程序员使用指南 - 连析工坊(Lianalytica)

## 欢迎使用💻
本指南将帮助软件开发者、数据分析师、算法工程师等技术专业人士使用WebUI进行代码分析、优化、文档生成和bug排查。


## 2. 安装与启动

### 2.1 选择合适版本
根据您的硬件配置选择对应的启动器版本：
- **OllamaWebUI_CPU.exe**：CPU 版本，需要支持 AVX2 指令集
- **OllamaWebUI_GPU.exe**：GPU 版本，需要 NVIDIA CUDA 11.0 以上
- **OllamaWebUI_GPU_MEM.exe**：GPU 内存优化版本，需要 8GB 以上 VRAM

### 2.2 启动软件
1. 双击对应版本的启动器
2. 等待 Ollama 服务自动启动（首次使用会自动安装 Ollama）
3. 浏览器会自动打开 WebUI 界面

## 3. 代码处理工作流程

### 3.1 代码文件上传

1. **登录界面**：打开软件后，首次使用会进入登录界面，输入任意用户名即可登录
2. **进入代码界面**：点击左侧导航栏的「代码分析」按钮
3. **上传代码文件**：
   - 点击界面中央的「选择文件」按钮
   - 支持常见编程语言：Python、JavaScript、Java、C++、Go、HTML、CSS 等
   - 支持单个文件或压缩包上传（ZIP、RAR 格式）
   - 建议单个文件大小不超过 5MB，压缩包不超过 50MB

### 3.2 代码分析功能

1. **选择分析类型**：在「分析类型」下拉菜单中选择「代码分析」
2. **调整参数**：
   - **分析深度**：默认为 0.7，数值越高分析越全面但速度越慢
   - **识别复杂度**：选择适合的代码复杂度识别级别（基础/进阶/深度）
3. **开始分析**：点击「开始分析」按钮
4. **查看结果**：
   - 代码结构可视化图谱
   - 函数调用关系图
   - 代码质量评分
   - 潜在问题提示

### 3.3 代码优化功能

1. **选择分析类型**：在「分析类型」下拉菜单中选择「代码优化」
2. **选择优化目标**：
   - 性能优化
   - 可读性优化
   - 内存优化
   - 安全性优化
3. **调整优化强度**：从保守到激进的优化级别
4. **开始优化**：点击「开始分析」按钮
5. **查看优化建议**：
   - 详细的优化点说明
   - 优化前后的代码对比
   - 预计性能提升百分比

### 3.4 文档生成功能

1. **选择分析类型**：在「分析类型」下拉菜单中选择「文档生成」
2. **选择文档格式**：
   - Markdown
   - HTML
   - PDF
   - API 文档（Swagger/OpenAPI）
3. **设置文档参数**：
   - 文档级别：概述/详细/API 参考
   - 包含示例代码：是/否
   - 包含流程图：是/否
4. **开始生成**：点击「开始分析」按钮
5. **下载文档**：生成完成后，点击「下载文档」按钮保存文件

## 4. API 使用指南

### 4.1 API 概述

软件提供了 RESTful API 接口，方便开发者集成到自己的工作流程中。所有 API 端点均以 `http://localhost:8001/api/` 为前缀。

### 4.2 认证

API 使用简单的会话认证机制，登录后会自动设置会话 Cookie。在调用 API 时，需要确保请求中包含有效的会话 Cookie。

### 4.3 主要 API 端点

#### 4.3.1 代码分析 API

```
POST /api/process/code
Content-Type: multipart/form-data

参数：
- file: 代码文件（必填）
- analysis_type: 分析类型（必填，可选值：analysis, optimization, documentation）
- depth: 分析深度（可选，默认 0.7）
- target: 优化目标（可选，仅 optimization 类型需要）
- format: 文档格式（可选，仅 documentation 类型需要）
```

**响应示例：**
```json
{
  "success": true,
  "task_id": "1234567890",
  "message": "代码分析任务已提交"
}
```

#### 4.3.2 任务状态查询 API

```
GET /api/task/status/{task_id}
```

**响应示例：**
```json
{
  "success": true,
  "task_id": "1234567890",
  "status": "completed",
  "result": {
    "analysis": {
      "quality_score": 85,
      "issues": [
        {
          "line": 42,
          "message": "未使用的变量",
          "severity": "warning"
        }
      ]
    }
  }
}
```

#### 4.3.3 分析结果获取 API

```
GET /api/task/result/{task_id}
```

**响应示例：**
```json
{
  "success": true,
  "task_id": "1234567890",
  "result": {
    "analysis": {
      "code_structure": {
        "functions": 25,
        "classes": 5,
        "lines": 1000
      },
      "quality_score": 85,
      "complexity": {
        "average_cyclomatic_complexity": 3.2
      },
      "issues": [
        {
          "line": 42,
          "message": "未使用的变量 'temp'",
          "severity": "warning"
        },
        {
          "line": 120,
          "message": "可能的空指针引用",
          "severity": "error"
        }
      ]
    }
  }
}
```

### 4.4 Python API 客户端示例

```python
import requests
import os

# 登录获取会话
login_url = "http://localhost:8001/api/login"
login_data = {"username": "test_user"}
session = requests.Session()
session.post(login_url, json=login_data)

# 上传代码文件进行分析
code_url = "http://localhost:8001/api/process/code"
files = {"file": open("example.py", "rb")}
data = {"analysis_type": "analysis", "depth": 0.8}
response = session.post(code_url, files=files, data=data)

if response.status_code == 200:
    task_id = response.json()["task_id"]
    print(f"任务提交成功，task_id: {task_id}")
    
    # 查询任务状态
    status_url = f"http://localhost:8001/api/task/status/{task_id}"
    while True:
        status_response = session.get(status_url)
        status_data = status_response.json()
        if status_data["status"] == "completed":
            print("任务完成！")
            print("分析结果：", status_data["result"])
            break
        elif status_data["status"] == "failed":
            print("任务失败：", status_data["message"])
            break
        else:
            print("任务处理中...")
            import time
            time.sleep(2)
else:
    print("请求失败：", response.text)
```

## 5. 扩展开发指南

### 5.1 插件系统介绍

软件支持插件扩展，可以通过开发插件来增加新的代码分析、优化或文档生成功能。

### 5.2 插件开发流程

1. **插件目录结构**：
   ```
   plugins/
   ├── my_plugin/
   │   ├── __init__.py
   │   ├── main.py
   │   └── config.json
   ```

2. **插件配置文件 (config.json)**：
   ```json
   {
     "name": "My Plugin",
     "version": "1.0.0",
     "description": "我的自定义代码分析插件",
     "author": "开发者姓名",
     "type": "code_analysis",
     "entry_point": "main.py:run_analysis"
   }
   ```

3. **插件主文件 (main.py)**：
   ```python
   def run_analysis(file_path, parameters):
       """
       插件主函数
       :param file_path: 待分析的文件路径
       :param parameters: 分析参数
       :return: 分析结果
       """
       
       # 读取文件内容
       with open(file_path, 'r', encoding='utf-8') as f:
           content = f.read()
       
       # 执行分析逻辑
       # ...
       
       # 返回分析结果
       return {
           "success": True,
           "data": {
               "custom_analysis_result": "分析完成",
               "metrics": {
                   "line_count": len(content.split('\n')),
                   "word_count": len(content.split())
               }
           }
       }
   ```

4. **安装插件**：
   - 将插件目录复制到软件的 `plugins` 目录下
   - 重启软件，插件会自动加载
   - 在代码分析界面的「插件」下拉菜单中选择您的插件

### 5.3 插件 API 参考

插件可以使用以下核心功能：

- **文件操作**：读取和写入文件
- **代码解析**：使用内置的代码解析器
- **结果可视化**：生成图表和报告
- **配置管理**：读取和保存配置参数

## 6. 高级功能

### 6.1 批量代码分析

1. **进入批量处理模式**：点击代码界面右上角的「批量处理」按钮
2. **选择多个文件或目录**：可以同时选择多个代码文件或整个目录
3. **设置统一参数**：为所有文件设置相同的分析参数
4. **开始批量分析**：点击「开始批量处理」按钮
5. **查看处理结果**：处理完成后，可以逐个查看和下载结果

### 6.2 代码质量监控

1. **设置监控目录**：在「设置」→「代码监控」中添加需要监控的代码目录
2. **配置监控规则**：设置监控频率、分析类型和通知方式
3. **开始监控**：点击「开始监控」按钮
4. **查看监控报告**：定期生成代码质量趋势报告

### 6.3 团队协作功能

1. **创建项目**：点击「项目管理」→「新建项目」
2. **邀请团队成员**：输入团队成员的邮箱地址发送邀请
3. **分配权限**：设置成员的访问权限（查看/编辑/管理）
4. **共享分析结果**：可以将分析结果共享给团队成员

## 7. 常见问题与解决方案

### 7.1 代码上传失败

**问题**：点击上传按钮后没有反应或提示上传失败

**解决方案**：
- 检查文件大小，确保单个文件不超过 5MB，压缩包不超过 50MB
- 检查文件格式，确保是支持的编程语言
- 检查网络连接是否正常
- 尝试刷新页面后重新上传

### 7.2 分析结果不准确

**问题**：代码分析或优化建议与预期不符

**解决方案**：
- 提高分析深度参数
- 确保代码文件完整且格式正确
- 尝试使用更适合的分析类型
- 对于复杂代码，可以尝试分段分析

### 7.3 API 调用失败

**问题**：使用 API 调用时返回错误

**解决方案**：
- 检查 API 端点 URL 是否正确
- 确保已登录并获取有效的会话 Cookie
- 检查请求参数是否符合要求
- 查看服务器日志获取详细错误信息

### 7.4 插件加载失败

**问题**：开发的插件无法加载

**解决方案**：
- 检查插件目录结构是否正确
- 确保 config.json 配置文件格式正确
- 检查插件代码是否存在语法错误
- 查看软件日志获取详细错误信息

## 8. 性能优化建议

### 8.1 硬件优化

- **使用 GPU 版本**：如果您的显卡支持 CUDA 11.0+，建议使用 GPU 版本以获得更好的性能
- **增加系统内存**：建议系统内存不低于 8GB，16GB 以上更佳
- **使用 SSD 存储**：可以显著提高文件读写速度

### 8.2 软件优化

- **调整分析参数**：根据实际需要调整分析深度和复杂度
- **关闭不必要的功能**：在设置中关闭不需要的功能模块
- **定期清理临时文件**：软件会自动清理临时文件，但也可以手动清理

## 9. 联系与支持

如果您在使用过程中遇到任何问题，可以通过以下方式获取支持：

- **邮箱**：27144726@qq.com
- **微信**：lianyiLin1031（请备注"连析工坊程序员用户"）
- **项目地址**：https://github.com/lyl-Ollamawebui
- **API 文档**：http://localhost:8001/api/docs（启动软件后访问）

## 10. 版权声明

本软件基于 Ollama 开源项目开发，所有功能仅供学习和开发使用。请勿将生成的代码或文档用于商业用途（除非您拥有原始代码的版权）。

---

**小贴士**：对于大型项目，建议先进行整体分析，再针对关键模块进行深度分析。祝您编程愉快！💻